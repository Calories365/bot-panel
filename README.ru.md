# Calories365: Счётчик калорий с Telegram-ботом и ИИ

**Calories365** — это веб-приложение и Telegram-бот, позволяющие удобно вести дневник питания, автоматически считывать голосовые сообщения и получать статистику по калориям (с помощью ИИ).

## [Попробуйте Дневник Калорий сейчас!](https://calculator.calories365.com)

---

## 1. Суть проекта

> **Запишите свою пищу и посмотрите, сколько калорий вы потребляете.**

- **Дневник калорий**  
  В нашем веб-приложении вы можете фиксировать всё, что съели за день. Найдите продукт в обширной базе или добавьте свой вариант — учтутся любые индивидуальные блюда и ингредиенты.

- **Наглядная статистика**  
  Отслеживайте динамику потребления калорий за разные периоды. Вы легко поймёте, если регулярно превышаете норму или, наоборот, укладываетесь в рекомендуемые показатели.

- **Телеграм-бот**  
  Подключите бота через личный кабинет и вносите данные **голосом**:
  1. Назовите продукт — бот переведёт ваш голос в текст и сформирует список блюд.
  2. Если вы не уточнили вес, бот предложит среднестатистические значения или сгенерирует КБЖУ с помощью искусственного интеллекта.
  3. При необходимости внесите коррективы и одним нажатием сохраните запись в дневнике.

- **Экономия времени**  
  Не нужно открывать сайт или устанавливать дополнительное приложение — достаточно Telegram. Всегда под рукой ежедневная статистика и быстрый ввод данных.

Таким образом, если ваша цель — **быстро** и **просто** считать калории, «Calories365» вместе с нашим ботом станет отличным решением.

---

## 2. Используемые технологии

- **Laravel** (с подключёнными пакетами **Laravel Sanctum** и **Laravel Fortify** для аутентификации и безопасности)
- **MySQL** — СУБД для хранения данных (пользователи, продукты, дневник).
- **Redis** — кэширование и хранение сессий.
- **Meilisearch** — поиск по базе продуктов.
- **Telegram SDK** — интеграция с Telegram.
- **FFmpeg** — конвертация аудио/видео (особенно при обработке голосовых сообщений).
- **Vue.js** — фронтенд фреймворк (SPA + динамические формы/таблицы).
- **OAuth** — протокол для авторизации (для авторизации через Google).
- **Docker** — контейнеризация и оркестрация (PHP-FPM, Nginx, MySQL, Redis).
- **Cloudflare** — проксирование и дополнительная защита на уровне DNS/SSL.

---

## 3. Архитектурные особенности

### 3.1 Backend архитектура для Telegram-ботов

В проекте есть отдельная «Bot Panel», реализующая **сервисный слой** (Service Layer) для управления ботами. Кроме того, **Bot Panel** функционирует как админ-панель, где можно:

- **Добавлять** и **конфигурировать** Telegram-ботов,
- **Мониторить** пользователей и ботов,
- Взаимодействовать с логикой обработки сообщений через удобный веб-интерфейс.

Основные моменты сервисного слоя:
1. **Контроллер** принимает Update от Telegram → передаёт в `TelegramHandler`.
2. **TelegramHandler** определяет, какой бот (стратегия) используется, пропускает данные через мидлвары (Laravel Pipeline) и вызывает соответствующую логику.
3. **Стратегии** (например, `CaloriesService`) наследуют базовый класс (`BaseService`), где регистрируются хендлеры:
   - `MessageUpdateHandler` (обработка текстов, голосовых, картинок)
   - `CallbackQueryHandler` (обработка inline-кнопок)
   - и другие.

Это обеспечивает гибкость добавления новых ботов и расширений.  
**Подробнее**: [См. отдельный README по сервисному слою ботов](./README.BotPanelArchitecture.ru.md)

### 3.2 Динамические формы и таблицы на Vue

Для фронтенда разработаны **универсальные** компоненты:
- Формы строятся на основе конфигов: каждый объект задаёт поле (тип, плейсхолдер, обязательность и т.д.).
- Таблицы также настраиваются конфигами: каждый объект в массиве описывает столбец (название, тип ячейки, лимит символов и прочее).

Это даёт возможность без изменения кода компонентов добавлять или удалять поля и столбцы.  
**Подробнее**: [См. отдельный README по динамическим формам/таблицам](./README.DynamicFormsAndTables.ru.md)

---

## 4. Среда разработки

- **Модифицированный Laradock**: единая среда с PHP-FPM, Node.js, MySQL, Redis, Meilisearch и т.д.
- **Ngrok**: удалённый доступ к локальному серверу (Telegram Webhook может приходить в локальную машину).
- **FFmpeg**: установлен для преобразования/анализа медиафайлов (голосовые сообщения).

---

## 5. CI/CD и деплой на сервер

### Кратко о настройках

- Развёртывание производится на **собственном сервере**, настроенном под Cloudflare (DNS/SSL).
- **Docker + docker-compose**: для каждого приложения (Calories365 и Bot Panel) есть набор контейнеров (PHP, Nginx, Redis, MySQL и др.). Сервисы общаются через **внутреннюю сеть Docker**.
- **GitHub Actions**: при пуше в `main` автоматом срабатывает деплой на сервер и сборка для продакшена.

### Подробности

- В каждом из **двух сервисов** (Calories365 и Bot Panel) присутствуют:
  - **Dockerfile**, использующий многоэтапную сборку (PHP, Node/Vite, Nginx).
  - **docker-compose.yml**, описывающий контейнеры и их зависимости.
  - **nginx.conf**, задающий виртуальный хост (серверные блоки) для каждого сервиса.

---

## 6. Заключение

**Calories365** — универсальный инструмент для подсчёта калорий и контроля своего рациона:
- **Telegram-бот** экономит ваше время благодаря голосовому вводу данных.
- **Веб-приложение** даёт наглядную статистику, широкую базу продуктов и удобный интерфейс.
- **Bot Panel** служит админкой для ботов и обеспечивает гибкую настройку логики Telegram, а также мониторинг пользователей.
- **Архитектура** (микросервисы внутри Docker, гибкие конфиги, CI/CD) упрощает дальнейшее развитие и масштабирование.

Если вам нужно **быстро** и **комфортно** следить за питанием — наш проект «Calories365» с Telegram-ботом и динамичным веб-кабинетом идеально подойдёт для этих задач!

---

> **Дополнительно**:
> - [**Архитектура сервисного слоя (Bot Panel)**](./README.BotPanelArchitecture.ru.md)  
> - [**Динамические формы и таблицы на Vue**](./README.DynamicFormsAndTables.ru.md)  
```
